<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_Clearer</spriteName>
  <solid>-1</solid>
  <visible>0</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if !instance_exists(obj_HUD)instance_create(x,y,obj_HUD)
if !instance_exists(obj_Lighting)instance_create(x,y,obj_Lighting)
if !instance_exists(obj_Levelup_Part)instance_create(x,y,obj_Levelup_Part)
if !instance_exists(obj_Bloom)instance_create(x,y,obj_Bloom)
if !instance_exists(obj_Particle)instance_create(x,y,obj_Particle)
if !instance_exists(obj_Shadow)instance_create(x,y,obj_Shadow)
//if !instance_exists(obj_Pause)instance_create(x,y,obj_Pause)
if !instance_exists(obj_Camera) instance_create(x,y,obj_Camera)    
global.W = room_width;
global.H = room_height;
global.SHOP = true;
global.max_chest = Random(3,8);
global.DARK = 0//choose(0,1);
SIZE = 6;
MIN = (4)*32;
MAX = (8)*32;

origx = room_width/2;
origy = room_height/2;
x = origx;
y = origy;
level_end = false;
SIZE_MAX = 7200;
SIZE = 0;
dir = choose(0,0,0,0,90,90,90,180,180,-180,-180,270,270);
prev_dir = dir;
var bx = 0;
var by = 0;
var bw = 256;
var bh = 256;


var spawn_squared_room=global.boss_rm+1 == 3;
var custom_dungeon = (global.dungeon_name == SECRET1_STORY);

//ROOM
if global.boss_rm+1!=3 &amp;&amp; !custom_dungeon {
    RWIDTH = 32*choose(2,3);
    RHEIGHT = RWIDTH;
    for(a=x-RWIDTH;a &lt; x + RWIDTH; a+=32)
    {
        for(b=y-RHEIGHT;b&lt;y+RHEIGHT;b+=32)
        {
            instance_create(a,b,obj_Clearer);
        }
    }
}

//PORTAL
if ( spawn_squared_room || global.tutorial ) {
    
    if !instance_exists(obj_Door)
            instance_create(bw/2,bh/2-64,obj_Door);    

    switch  (global.coop) {     

        case false://Single Player
        
        //CHAR
        if ( !instance_exists(obj_Hero) ) {
            //instance_create(bw/2,bh/2+32,obj_Hero)
            with (instance_create(bw/2,bh/2+32,obj_Hero)) { player = 0;}
            } else {
            with ( obj_Hero ) {
                x = bw/2;
                y = bh/2+32;
                if !instance_exists(obj_Beam) then instance_create(x,y,obj_Beam)            
            }
        }
        break;
        
        case true://Coop
        //CHAR
        if ( !instance_exists(obj_Hero) ) {
            with (instance_create(bw/2,bh/2+32,obj_Hero)) { player = 0;}
              var player1 = instance_find(obj_Hero,0);
              global.player_1 = instance_find(obj_Hero,0);
            } else {
            with ( player1 ) {
                x = bw/2;
                y = bh/2+32;
                if !instance_exists(obj_Beam) then instance_create(x,y,obj_Beam)            
            }
        }
        
        if ( !instance_exists(obj_Hero) ) {
             with (instance_create(bw/2,bh/2+80,obj_Hero)) { player = 1;}
             var player2 = instance_find(obj_Hero,1);
              global.player_2 = instance_find(obj_Hero,1);
            } else {
            with ( player2 ) {
                x = bw/2;
                y = bh/2+80;
                if !instance_exists(obj_Beam) then instance_create(x,y,obj_Beam)            
            }
            
        }
        break;
    }           
} else if (custom_dungeon) {
    var tbw=1024;
    var tbh=256;
    if !instance_exists(obj_Door)
        instance_create(-32+tbw,tbh/4,obj_Door);
    //CHAR
    if !instance_exists(obj_Hero) {
        with ( instance_create(tbw/4,tbh/4+32,obj_Hero) ) {
            player = 0;
        }
        
        if (global.coop) {
            with ( instance_create(tbw/4,tbh/4+72,obj_Hero) ) {
                player = 1;
            }
        }
    } else
    {
        with obj_Hero {
            x = bx+32;
            y = by+32;
            if !instance_exists(obj_Beam) instance_create(x,y,obj_Beam)            
        } 
    }
        
    instance_create(bx+tbw/5,tbh/4,obj_Lore_Book_I);
    instance_create(bx+2*tbw/5,tbh/4,obj_Lore_Book_II);
    instance_create(bx+3*tbw/5,tbh/4,obj_Lore_Book_III);
    instance_create(bx+4*tbw/5,tbh/4,obj_Lore_Book_IV);
    
    add_notification(spr_Lore_Book,0,"Read the diary entries",3);
    
    instance_create(0,0,obj_Lore_Reader_Force);
    var o = instance_create(0,0,obj_Lore_Block_Door);
    o.reason="Read diary entries";
}
else
{
    if !instance_exists(obj_Door)
        instance_create(x+8,y+8,obj_Door);
        
    //CHAR
    if !instance_exists(obj_Hero) {
        //instance_create(x+16,y+16,obj_Hero)
        with ( instance_create(x+16,y+16,obj_Hero) ) {
            player = 0;
        }
        if (global.coop) {
            with ( instance_create(x+6,y+32,obj_Hero) ) {
                player = 1;
            }
        }
        
    } else
        with obj_Hero {
            x = other.x;
            y = other.y;
        } 
    if !instance_exists(obj_Beam) instance_create(x,y,obj_Beam)               
}


//GENERATE
if ( spawn_squared_room || global.tutorial ) {

       for (i=bx;i&lt;bw;i+=32) {
            for (j=by;j&lt;bh;j+=32)
            {
                if (i == bx+64 or i == bx+192) and  (j == by+64 or j == by+192) and global.tutorial == false
                    instance_create(i,j,obj_Floor_Arrow_Trap);
                instance_create(i,j,obj_Clearer);
                instance_create(i,j,obj_Floor_Mark);
                         
            }
        }
}
else if (custom_dungeon)
{
    var tbw=1024;
    var tbh=256;
    for (i=bx;i&lt;tbw;i+=32)
    {
        for (j=by;j&lt;tbh/2;j+=32)
        {
            //if (i == bx+64 or i == bx+192) and  (j == by+64 or j == by+192) and global.tutorial == false
            //    instance_create(i,j,obj_Floor_Arrow_Trap);
            instance_create(i,j,obj_Clearer);
            //instance_create(i,j,obj_Floor_Mark);
                     
        }
    }
}
else
{
    while(!level_end)
    {
        len = 32;
        if (random(100) &lt; 30)
        {
            dir = choose(0,0,0,0,90,90,90,180,180,-180,-180,270,270);         
        }            
        
        SIZE += 32;
        x = x+lengthdir_x(len,dir);
        y = y+lengthdir_y(len,dir);
        instance_create(x,y,obj_Clearer);                
        if ( SIZE &gt;= SIZE_MAX )
            level_end = true
        else
        if ( SIZE &lt; SIZE_MAX )
        {
             if x+lengthdir_x(len,dir) &lt; 96 or x+lengthdir_x(len,dir) &gt; room_width-96 or y+lengthdir_y(len,dir) &lt; 96 or y+lengthdir_y(len,dir) &gt; room_height-96
            {           
                x = origx;
                y = origy;
            }                      
        }
    }
}

with obj_Clearer
{
    if (!tile_layer_find(100,x-32,y) and !tile_layer_find(100,x,y-32) and !tile_layer_find(100,x+32,y)) or //TOP
    (!tile_layer_find(100,x+32,y) and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x-32,y)) or //DOWN
    (!tile_layer_find(100,x-32,y) and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32)) or //LEFT
    (!tile_layer_find(100,x+32,y) and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32)) //RIGHT
    {
        ///instance_create(x,y,obj_Floor_Mark)
        //ROOM
        RWIDTH = 32*choose(2,2);
        RHEIGHT = RWIDTH;
        for(a=x-RWIDTH;a&lt;x+RWIDTH;a+=32)
        {
            for(b=y-RHEIGHT;b&lt;y+RHEIGHT;b+=32)
            {
                //if (a==x-RWIDTH or a==x+RWIDTH-32) or (b==y-RHEIGHT or b=y+RHEIGHT-32)
                //    if !instance_place(a,b,obj_Clearer) instance_create(a,b,obj_Wall);
                //else
                    instance_create(a,b,obj_Clearer);
                    instance_create(x,y,obj_Floor_Mark);
            }
        }
          if ( !instance_exists(obj_Merchant) and distance_to_object(obj_Hero) &gt; 32 and distance_to_object(obj_Door) &gt; 32 and !spawn_squared_room and !custom_dungeon )
            instance_create(x,y,obj_Merchant)                
        //MARK
        if place_free(x,y) 
        and distance_to_object(obj_Hero)&gt;128 
        and distance_to_object(obj_Merchant)&gt;128 
        and distance_to_object(obj_Mark)&gt;128 
        and global.boss_rm+1 != 3 and instance_number(obj_Mark) &lt; 5
            instance_create(x+8,y+8,obj_Mark)
        //else
        //    instance_create(x+8,y+8,obj_Shrine)
    }
}

//BOSSES
if spawn_squared_room
{    
    if global.dungeon_name == ENVIRO1
    {
        /*repeat(global.loop) */if instance_number(BOSS1) &lt; 5 instance_create(bw/2,48,BOSS1);
        set_cutscene_displayed(true);
        cutscene_cam_set_target(BOSS1);
        var necro_offset=0;
        if (obj_Hero.attack_type[global.choice]== "NECRO")
        {
            necro_offset=0.25;
        }
        var _rchoice,_triggerChance;
        _triggerChance=(1-necro_offset)*.5
        _rchoice = random(1);
        if (_rchoice&lt;necro_offset)
        {
            cutscene_add_message("Betrayer of our kind... You dare to challenge me?!",4.5,snd_skeleton_king_intronecro_part1);
            cutscene_add_message("I'll show you the true power of the undead!",4.5,snd_skeleton_king_intronecro_part2);
        }
        else if (_rchoice&lt;necro_offset+_triggerChance)
        {
            cutscene_add_message("So, you want to escape, huh?",3.5,snd_skeleton_king_introb_part1);
            cutscene_add_message("Let's see how badly you want your freedom!",3.5,snd_skeleton_king_introb_part2);
        }
        else
        {
            cutscene_add_message("Hm... What is this? An escape?",3.5,snd_skeleton_king_introa_part1);
            cutscene_add_message("I'll send you back to your grave!",3.5,snd_skeleton_king_introa_part2);
        }
    }
    if global.dungeon_name == SECRET1
    {
        /*repeat(global.loop)*/ if instance_number(SBOSS1) &lt; 5 instance_create(bw/2,48,SBOSS1);
        set_cutscene_displayed(true);
        cutscene_cam_set_target(SBOSS1);
        if (!killed_owl)
        {
            if (owl_nice_value&lt;5)
            {
                if (random(1)&lt;0.5)
                {
                        cutscene_add_message("Welcome to my library.",3,-1);
                        cutscene_add_message("Something tells me you're lost.",3,-1);
                        cutscene_add_message("Perhaps, I should show you#the way out?",5,-1);
                }
                else
                {
                    cutscene_add_message("Have you come to#return that book?",5,-1);
                    cutscene_add_message("I did wonder#where it went...",4,-1);
                }
            }
        }
        else
        {
            if (!killed_dark_merlin)
            {
                cutscene_add_message("You...!",3,-1);
                cutscene_add_message("I hate you!",2,-1);
            }
            else
            {
                cutscene_add_message("Why...?",3,-1);
            }
        }
    }
    if global.dungeon_name == ENVIRO2
    {
        /*repeat(global.loop)*/ if instance_number(BOSS2) &lt; 5 instance_create(bw/2,48,BOSS2);
        set_cutscene_displayed(true);
        cutscene_cam_set_target(BOSS2);
        var thief_offset=0,death_offset=0,worm_offset=0.1;
        if (obj_Hero.attack_type[global.choice]== "KNIFE")
        {
            thief_offset=0.25;
        }
        if (died_slime_boss&gt;0)
        {
            death_offset=0.35;
        }
        var _rchoice,_triggerChance;
        _triggerChance=(1-thief_offset-death_offset-worm_offset)*.5
        _rchoice = random(1);
        if (_rchoice&lt;thief_offset)
        {
            cutscene_add_message("You think you're special, huh?",2.5,-1);
            cutscene_add_message("Well, you're not the only one who's see-through.",3.5,-1);
        }
        else if (_rchoice&lt;thief_offset+death_offset)
        {
            cutscene_add_message("How many times will I have to digest you?",3.4,-1);
            cutscene_add_message("My tummy likes variety, you know?",3,-1);
        }
        else if (_rchoice&lt;thief_offset+death_offset+worm_offset)
        {
            cutscene_add_message("What?",1,snd_slime_boss_introb_part1);
            cutscene_add_message("Were you expecting some kind of worm?",3,-1);
        }
        else if (_rchoice&lt;thief_offset+death_offset+worm_offset+_triggerChance)
        {
            cutscene_add_message("Oh look! A hero!",1.8,-1);
            cutscene_add_message("Just the snack that I needed!",2.5,-1);
        }
        else
        {
            cutscene_add_message("See this skull? It belonged to a huge beast.",4.5,-1);
            cutscene_add_message("I wonder if I can use yours as a helmet...#Or a necklace!",5.5,-1);
        }
    }
    if global.dungeon_name == ENVIRO3
    {
        if instance_number(BOSS3) &lt; 5 instance_create(bw/2,48,BOSS3);
        
        set_cutscene_displayed(true);
        cutscene_cam_set_target(BOSS3);
        var magician_offset=0,barbarian_offset=0;
        if (obj_Hero.attack_type[global.choice]== "AXE") {
            barbarian_offset=0.25;
        }
        else if (obj_Hero.attack_type[global.choice]== "MAGIC")
        {
            magician_offset=0.25;
        }
        _triggerChance=(1-magician_offset-barbarian_offset)*.5
        _rchoice = random(1);
        if (_rchoice&lt;magician_offset+barbarian_offset)
        {
            if (magician_offset&gt;0)
            {
                if (random(1)&lt;0.5) {
                    cutscene_add_message("I am not particularly fond of your spells.",4.5,snd_lady_laine_spell_fond_intro);
                    cutscene_add_message("The more reason to kill you.",4,snd_lady_laine_more_reason_intro);
                }
                else {
                    cutscene_add_message("The melting ice warned me of your presence.",5,snd_lady_laine_melting_ice_intro);
                    var snd_index = -1; //The sound index to use.
                    if (random(1)&lt;0.5) {
                        snd_index = snd_lady_laine_melt_attack_intro_a;
                    }
                    else
                    {
                        snd_index = snd_lady_laine_melt_attack_intro_b;
                    }
                    cutscene_add_message("Let's see if you can melt my attacks!",4,snd_index);
                }
            }
            else
            {
                cutscene_add_message('"'+"Don't shout or an avalanche might come."+'"',3.8,snd_lady_laine_avalanche_intro);
                cutscene_add_message("You've clearly never heard this before.",4,snd_lady_laine_never_heard_intro);
            }
        }
        else 
        {
            _rchoice = random(1);
            if (_rchoice&lt;0.4)
            {
                cutscene_add_message("I was expecting you.",3,snd_lady_laine_expecting_intro);
                cutscene_add_message("I shall make you succumb to eternal snow",4,snd_lady_laine_succumb_intro);
            }
            else
            {
                cutscene_add_message("The winter marks the slumber of all creatures.",4.5,snd_lady_laine_winter_intro);
                cutscene_add_message("I, like the winter, shall send you to sleep.",4.5,snd_lady_laine_send_sleep_intro);
            }
        }
    }
    if global.dungeon_name == SECRET2        
        /*repeat(global.loop)*/ if instance_number(SBOSS2) &lt; 5 instance_create(bw/2,48,SBOSS2);
    if global.dungeon_name == ENVIRO4
    {
        /*repeat(global.loop)*/ if instance_number(BOSS4) &lt; 5 instance_create(bw/2,48,BOSS4);
        set_cutscene_displayed(true);
        cutscene_cam_set_target(BOSS4);
        var cleric_offset=0,knight_offset=0,night_offset=0;
        if (obj_Hero.attack_type[global.choice]== "HEAL")
        {
            cleric_offset=0.167;
        }
        else if (obj_Hero.attack_type[global.choice]== "SWORD")
        {
            knight_offset=0.166;
        }
        else if (obj_Hero.attack_type[global.choice]== "NIGHT")
        {
            night_offset=0.167;
        }
        var _rchoice,_triggerChance;
        _triggerChance=(1-cleric_offset-knight_offset-night_offset)*.5
        _rchoice = random(1);
        if (_rchoice&lt;cleric_offset &amp;&amp; obj_Hero.attack_type[global.choice]=="HEAL")
        {
            cutscene_add_message("Huh... A cleric?",3,snd_soul_guardian_introf_part1);
            cutscene_add_message("How did you kill me? And who?",4,snd_soul_guardian_introf_part2);
            cutscene_add_message("Nevermind, it matters not.",3,snd_soul_guardian_introf_part3);
            cutscene_add_message("I shall redeem my past self with your death!",3.7,snd_soul_guardian_introf_part4);
        }
        else if (_rchoice&lt;cleric_offset+knight_offset &amp;&amp; obj_Hero.attack_type[global.choice]=="SWORD")
        {
            cutscene_add_message("A warrior?",2,snd_soul_guardian_introg_part1);
            cutscene_add_message("That armor you're wearing...",3,snd_soul_guardian_introg_part2);
            cutscene_add_message("You'll eventually realize it means nothing...",3.5,snd_soul_guardian_introg_part3);
            cutscene_add_message("Nobility is worthless.",4,snd_soul_guardian_introg_part4);
        }
        else if (_rchoice&lt;cleric_offset+knight_offset+night_offset &amp;&amp; obj_Hero.attack_type[global.choice]=="NIGHT")
        {
            cutscene_add_message("You stole a necromancer's life for your own resurrection.",5,snd_soul_guardian_introe_part1);
            cutscene_add_message("I shall now steal your body's life, for similar reasons.",5,snd_soul_guardian_introe_part2);
        }
        else
        {
            var partition=1,soul_death=0,number_deaths=0;
            _rchoice = random(1);
            if (died_soul_guardian)
            {
                partition++;
                soul_death=1;
            }
            if (global.deaths&gt;5)
            {
                partition++;
                number_deaths=1;
            }
            var _offset = 1/(partition);
            if (_rchoice&lt;_offset)
            {
                if (random(1)&lt;0.5 &amp;&amp; visited_forbidden_chambers)
                {
                    cutscene_add_message("Have you come to get your soul orb?",3.5,snd_soul_guardian_introd_part1);
                    cutscene_add_message("Your stay in the Forbidden Library seems#to have been truly enlightening.",5.2,snd_soul_guardian_introd_part2);
                    cutscene_add_message("But as you may know, I cannot#let you take it.",4.7,snd_soul_guardian_introd_part3);
                }
                else
                {
                    cutscene_add_message("Finally, you have arrived!",3.5,snd_soul_guardian_introa_part1);
                    cutscene_add_message("You've been causing quite a havoc in the dungeon.",4.1,snd_soul_guardian_introa_part2);
                    cutscene_add_message("Unfortunately for you it is my duty to stop you.",5,snd_soul_guardian_introa_part3);
                }
            }
            else if (_rchoice&lt;2*_offset &amp;&amp; soul_death)
            {
                cutscene_add_message("She did say heroes were persistent.",3.1,snd_soul_guardian_introc_part1);
                cutscene_add_message("But persistence is futile against me.",3.3,snd_soul_guardian_introc_part2);
                cutscene_add_message("I will keep sending you back time, and time, again!",4.4,snd_soul_guardian_introc_part3);
            }
            else if (number_deaths || soul_death)
            {
                cutscene_add_message("Why are you so desperate to escape?",3.3,snd_soul_guardian_introb_part1);
                cutscene_add_message("Let your body rest in peace.",3.1,snd_soul_guardian_introb_part2);
                cutscene_add_message("Let us be in peace.",3,snd_soul_guardian_introb_part3);
            }
        }
    }
    if global.dungeon_name == ENVIRO5
    {
        if instance_number(BOSS5) &lt; 5 instance_create(bw/2,32,BOSS5);        
        set_cutscene_displayed(true);
        cutscene_cam_set_target(BOSS5);
        var arrow_offset=0;
        if (obj_Hero.attack_type[global.choice]== "ARROW")
        {
            arrow_offset=0.167;
        }
        var _rchoice,_triggerChance;
        _triggerChance=(1-arrow_offset)*.5
        _rchoice = random(1);
        if (_rchoice&lt;arrow_offset &amp;&amp; obj_Hero.attack_type[global.choice]=="ARROW")
        {
            cutscene_add_message("Your arrows will never pierce my skin!",4,snd_judgement_arrows_intro);
        }
        else
        {
            var partition=1,judge_death=0,number_deaths=0;
            _rchoice = random(1);
            if (died_judgement)
            {
                partition++;
                judge_death=1;
            }
            if (died_judgement&gt;2)
            {
                partition++;
                number_deaths=1;
            }
            var _offset = 1/(partition);
            if (_rchoice&lt;_offset)
            {
                if (killed_owl &amp;&amp; random(1)&lt;0.5)
                {
                    cutscene_add_message("My fellow demon!",2.2,snd_judgement_fellow_demon_intro);
                    cutscene_add_message("I am afraid I cannot let you pass.",3,snd_judgement_cannot_pass_intro);
                    cutscene_add_message("You are too benelovent.",2,snd_judgement_benelovent_intro);
                }
                else if (random(1)&lt;0.5)
                {
                    cutscene_add_message("Let's see if you have what it takes to meet her.",3.6,snd_judgement_meet_her_intro);
                }
                else
                {
                    cutscene_add_message("How fitting!",1.2,snd_judgement_how_fitting_intro);
                    cutscene_add_message("Your whole journey will be in vain when I am done with you.",4,snd_judgement_vain_journey_intro);
                }
            }
            else if (_rchoice&lt;2*_offset &amp;&amp; judge_death)
            {
                cutscene_add_message("A weakling like you will never get past me.",5.8,snd_judgement_weakling_intro);
            }
            else if (number_deaths)
            {
                cutscene_add_message("How weak can you be to have died so many times?",4.4,snd_judgement_weak_hero_intro);
                cutscene_add_message("And you dare call yourself a hero?!",5,snd_judgement_call_hero_intro);
            }
        }
    }
    if (global.dungeon_name==SECRET1_STORY)
    {
        var extra_offset=0;
        if (killed_owl)
        {
            extra_offset=-32
        }
        var ob = instance_create(bw/2,-32+bh/2,obj_Lore_Merlin);
        var o = instance_create(0,0,obj_Lore_Block_Door);
        o.reason="Kill Merlin";
        set_cutscene_displayed(true);
        cutscene_cam_set_target(ob);
        if (!killed_owl)
        {
            cutscene_add_message("So... You've read my diary entries.",-16,-1);
            cutscene_add_message("Hm... Funny how even though I should kill you, I can't.",-16,-1);
            if (owl_nice_value&lt;5) //If hasn't befriended owl.
            {
                cutscene_add_message("Well, I believe I'm better off letting you go.",-16,-1);
                cutscene_add_message("There's no point in fighting you again.",-16,-1);
                cutscene_add_message("I feel you're of no need to harm,#even if it is for the core's sake.",-16,-1);
                cutscene_add_message("If you are truly the one,#then not even Selene can stop you.",-16,-1);
            }
            else
            {
                cutscene_add_message("It appears my daughter, Celestia,#has started to like you.",-16,-1);
                cutscene_add_message("Have you noticed it too?",-16,-1);
                cutscene_add_message("It seems it would sadden her quite#a lot if I were to kill.",-16,-1);
                cutscene_add_message("Perhaps, I should try to search#for another way to free Celestia.",-16,-1);
                cutscene_add_message("Or maybe your freedom might help me save her.",-16,-1);
                cutscene_add_message("Well, who knows, right?",-16,-1);
                cutscene_add_message("As long as you keep treating her nicely",-16,-1);
                cutscene_add_message("I will make your life easier.",-16,-1);
                cutscene_add_message("Hm...",-16,-1);
                cutscene_add_message("I shouldn't do this but...#Here, I hope this helps you.",-16,-1);
            }
        }
        else
        {
            if (dark_merlin_deaths==0)
            {
                cutscene_add_message("What kind of monster are you...?",-16,-1);
                cutscene_add_message("You just took everything I had... Everything I loved...",-16,-1);
                cutscene_add_message("In just ONE strike...",-16,-1);
                cutscene_add_message("You are no hero. You're a wretched demon.",-16,-1);
                cutscene_add_message("An apple soon to be rotten that fell before its time.",-16,-1);
                cutscene_add_message("You never deserved to live, let alone re-live again.",-16,-1);
                cutscene_add_message("I'll make sure I'll never let a killer#like you achieve freedom.",-16,-1);
                cutscene_add_message("If you thought you were in hell - you're in for a treat.",-16,-1);
                cutscene_add_message("Because what I have in store for you, is nothing the compared#to the likes of this dungeon.",-16,-1);
                cutscene_add_message("I. Will. Destroy. You.",-16,-1);
            }
            else if (dark_merlin_deaths==7)
            {
                cutscene_add_message("You know what they say about#the number 7...",-16,-1);
                cutscene_add_message("Too bad luck does not favour#you against me.",-16,-1);
            }
            else if (dark_merlin_deaths==3)
            {
                cutscene_add_message("Are you that pathetically easy to kill?",-16,-1);
                cutscene_add_message("I wonder how you even managed#to break the barrier.",-16,-1);
            }
            else if (dark_merlin_deaths==10)
            {
                cutscene_add_message("10 times? Really?",-16,-1);
                cutscene_add_message("Boy do you like to get killed.",-16,-1);
            }
            else if (dark_merlin_deaths==4)
            {
                cutscene_add_message("How funny.",-16,-1);
                cutscene_add_message("My diary has an entry number#with the same number has your deaths.",-16,-1);
                cutscene_add_message("4, to be precise (in case you aren't counting).",-16,-1);
            }
            else if (dark_merlin_deaths==2)
            {
                cutscene_add_message("Hm... Misery loves company!",-16,-1);
                cutscene_add_message("Specially in pairs of 2!",-16,-1);
            }
            else
            {
                cutscene_add_message("Back for more?",-16,-1);
            }
        }
        
    }
    
    ///POTIONS
    if Item_In_List(spr_Empty_Bottle)
    {
        with instance_create((bw/2)+lengthdir_x(24,0),(bh/2+32)+lengthdir_y(24,0),Random_Potion()) item_price = 0;
        with instance_create((bw/2)+lengthdir_x(24,90),(bh/2+32)+lengthdir_y(24,90),Random_Potion()) item_price = 0;
        with instance_create((bw/2)+lengthdir_x(24,180),(bh/2+32)+lengthdir_y(24,180),Random_Potion()) item_price = 0;
        with instance_create((bw/2)+lengthdir_x(24,270),(bh/2+32)+lengthdir_y(24,270),Random_Potion()) item_price = 0;
    }    
} 

//    with obj_Clearer
//       instance_destroy();
if spawn_squared_room || custom_dungeon
{
    with obj_Clearer
        if instance_place(x-32,y,obj_Wall) or instance_place(x+32,y,obj_Wall) or instance_place(x,y+32,obj_Wall) or instance_place(x,y-32,obj_Wall)
            instance_destroy();
}
instance_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///With Clearer
/*with obj_Wall
{
    if des = true
    {
        tile_add(global.tile_top,0,0,32,32,x,y-8,-room_height+1);    
        instance_destroy();
    }
}
with obj_Wall
{
    if instance_place(x+32,y,obj_Wall) and instance_place(x-32,y,obj_Wall) and instance_place(x,y+32,obj_Wall) and instance_place(x,y-32,obj_Wall)
        des = true;
}*/
/*with obj_Wall
{
    //CORNER
    if tile_layer_find(100,x-32,y+32) and !instance_place(x-32,y+32,obj_Wall)// and !instance_place(x,y+32,obj_Wall) 
    {tile_add(global.outline,0,64,32,32,x,y-16,-y*3);}//BOTTOM LEFT
    if tile_layer_find(100,x-32,y-32) and !instance_place(x-32,y,obj_Wall) and !instance_place(x,y-32,obj_Wall) 
    {tile_add(global.outline,0,0,32,32,x,y-16,-y*3);}//TOP LEFT
    if tile_layer_find(100,x+32,y-32) and !instance_place(x+32,y,obj_Wall) and !instance_place(x,y-32,obj_Wall) 
    {tile_add(global.outline,64,0,32,32,x,y-16,-y*3);}//TOP RIGHT        
    if tile_layer_find(100,x+32,y+32) and !instance_place(x+32,y,obj_Wall) and !instance_place(x,y+32,obj_Wall) 
    {tile_add(global.outline,64,64,32,32,x,y-16,-y*3);}//BOTTOM RIGHT  
}*/
/*with obj_Wall
{   
    if tile_layer_find(100,x-32,y) and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32) and !tile_layer_find(-room_height+1,x-32,y)
    {tile_add(global.outline,0,32,32,32,x,y-16,-y*3); if global.DARK == 0if floor(random(8))==1 instance_create(x-4,y+8,obj_Lantern);} //LEFT
    
    if tile_layer_find(100,x+32,y) and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32)  and !tile_layer_find(-room_height+1,x+32,y)
    {tile_add(global.outline,64,32,32,32,x,y-16,-y*3); if global.DARK == 0if floor(random(8))==1 instance_create(x+37,y+8,obj_Lantern);}//RIGHT
    
    if tile_layer_find(100,x,y-32) and !tile_layer_find(100,x+32,y) and !tile_layer_find(100,x-32,y) and !tile_layer_find(-room_height+1,x,y-32)
    {tile_add(global.outline,32,0,32,32,x,y-16,-y*3); if global.DARK == 0 if floor(random(8))==1 instance_create(x+16,y-8,obj_Lantern);}//TOP
    
    if tile_layer_find(100,x,y+32) and !tile_layer_find(100,x+32,y) and !tile_layer_find(100,x-32,y) and !tile_layer_find(-room_height+1,x,y+32)
    {tile_add(global.outline,32,64,32,32,x,y-16,-y*3); if global.DARK == 0if floor(random(8))==1 instance_create(x+16,y+12,obj_Lantern);}//BOTTOM
    
    //CORNER
    if tile_layer_find(100,x-32,y+32) and !instance_place(x-32,y,obj_Wall) and !instance_place(x,y+32,obj_Wall) 
    {tile_add(global.outline,0,64,32,32,x,y-16,-y*3);}//BOTTOM LEFT
    if tile_layer_find(100,x-32,y-32) and !instance_place(x-32,y,obj_Wall) and !instance_place(x,y-32,obj_Wall) 
    {tile_add(global.outline,0,0,32,32,x,y-16,-y*3);}//TOP LEFT
    if tile_layer_find(100,x+32,y-32) and !instance_place(x+32,y,obj_Wall) and !instance_place(x,y-32,obj_Wall) 
    {tile_add(global.outline,64,0,32,32,x,y-16,-y*3);}//TOP RIGHT        
    if tile_layer_find(100,x+32,y+32) and !instance_place(x+32,y,obj_Wall) and !instance_place(x,y+32,obj_Wall) 
    {tile_add(global.outline,64,64,32,32,x,y-16,-y*3);}//BOTTOM RIGHT
    
    //DECAl
    randomize();
    var decalxx = choose(0,64);
    var decalyy = choose(0,32);
    if (tile_layer_find(100,x,y+32) and tile_layer_find(100,x+48,y) and instance_place(x+64,y,obj_Wall)) or
    (tile_layer_find(100,x,y-32) and tile_layer_find(100,x+48,y) and instance_place(x+64,y,obj_Wall))
    then tile_add(global.decal,decalxx,decalyy,64,32,x+16,y-16,-room_height*2)

    //if !(tile_layer_find(100,x,y-32) and !tile_layer_find(-room_height+1,x,y-32))
    tile_add(global.tile_top,0,0,32,32,x,y-16,-y*2)
}
//if !instance_exists(obj_Block_Top)instance_create(x,y,obj_Block_Top)
//
/*with obj_Clearer 
{

    if instance_place(x-32,y,obj_Wall) or instance_place(x+32,y,obj_Wall) or instance_place(x,y-32,obj_Wall) or instance_place(x,y+32,obj_Wall)
        instance_destroy();
    else
        event_user(0);
}*/
//with obj_Clearer2 instance_destroy();



/*with obj_Wall
{
    if tile_layer_find(100,x,y+32) and !tile_layer_find(-room_height+1,x,y+32)
    {
        if !instance_exists(obj_Door) and instance_place(x-32,y,obj_Wall) and instance_place(x+32,y,obj_Wall)
            instance_create(x+16,y+24,obj_Door);
    }
}*/


with obj_Clearer
{
    if !tile_layer_find(100,x-32,y-32) then instance_create(x-32,y-32,obj_Wall);
    if !tile_layer_find(100,x,y-32) then instance_create(x,y-32,obj_Wall);
    if !tile_layer_find(100,x+32,y-32) then instance_create(x+32,y-32,obj_Wall);

    if !tile_layer_find(100,x-32,y) then instance_create(x-32,y,obj_Wall);
    if !tile_layer_find(100,x+32,y) then instance_create(x+32,y,obj_Wall);

    if !tile_layer_find(100,x-32,y+32) then instance_create(x-32,y+32,obj_Wall);
    if !tile_layer_find(100,x,y+32) then instance_create(x,y+32,obj_Wall);
    if !tile_layer_find(100,x+32,y+32) then instance_create(x+32,y+32,obj_Wall);
    if global.boss_rm+1 != 3 then instance_destroy();    
}
with obj_Wall
{
    var custom_dungeon = (global.dungeon_name==SECRET1_STORY);
    if !tile_layer_find(100,x,y) 
    {
        if tile_layer_find(100,x-32,y) and tile_layer_find(100,x,y+32) then tile_add(global.outline,0,64,32,32,x,y-12,-y*3);//BOTTOM LEFT
        if tile_layer_find(100,x-32,y) and tile_layer_find(100,x,y-32) then tile_add(global.outline,0,0,32,32,x,y-12,-y*3);//TOP LEFT
        if tile_layer_find(100,x+32,y) and tile_layer_find(100,x,y-32) then tile_add(global.outline,64,0,32,32,x,y-12,-y*3);//TOP RIGHT        
        if tile_layer_find(100,x+32,y) and tile_layer_find(100,x,y+32) then tile_add(global.outline,64,64,32,32,x,y-12,-y*3);//BOTTOM RIGHT     
        
        //DECAl
        randomize();
        var decalxx = choose(0,64);
        var decalyy = choose(0,32);
        if (tile_layer_find(100,x,y+32) and tile_layer_find(100,x+48,y) and instance_place(x+64,y,obj_Wall)) or
        (tile_layer_find(100,x,y-32) and tile_layer_find(100,x+48,y) and instance_place(x+64,y,obj_Wall))
        then tile_add(global.decal,decalxx,decalyy,64,32,x+16,y-16,-room_height*2)
              
        if (!custom_dungeon)
        {
            if tile_layer_find(100,x,y-32) //and !tile_layer_find(100,x+32,y) and !tile_layer_find(100,x-32,y) and !tile_layer_find(-room_height+1,x,y-32)
            {tile_add(global.outline,32,0,32,32,x,y-12,-y*3); if global.DARK == 0 if random(20)&lt;1 and !instance_place(x+16,y+12,obj_Lantern) instance_create(x+16,y-8,obj_Lantern);}//TOP
            if tile_layer_find(100,x-32,y) //and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32) and !tile_layer_find(-room_height+1,x-32,y)
            {tile_add(global.outline,0,32,32,32,x,y-12,-y*3); if global.DARK == 0 if random(20)&lt;1 instance_create(x-4,y+8,obj_Lantern);} //LEFT    
            if tile_layer_find(100,x+32,y) //and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32)  and !tile_layer_find(-room_height+1,x+32,y)
            {tile_add(global.outline,64,32,32,32,x,y-12,-y*3); if global.DARK == 0 if random(20)&lt;1 instance_create(x+37,y+8,obj_Lantern);}//RIGHT        
            if tile_layer_find(100,x,y+32) //and !tile_layer_find(100,x+32,y) and !tile_layer_find(100,x-32,y) and !tile_layer_find(-room_height+1,x,y+32)
            {tile_add(global.outline,32,64,32,32,x,y-12,-y*3); if global.DARK == 0 if random(20)&lt;1 and !instance_place(x+16,y+12,obj_Lantern) with instance_create(x+16,y+12,obj_Lantern) {depth= -y*4;}}//BOTTOM        
        }
        else
        {
            if tile_layer_find(100,x,y-32) //and !tile_layer_find(100,x+32,y) and !tile_layer_find(100,x-32,y) and !tile_layer_find(-room_height+1,x,y-32)
            {tile_add(global.outline,32,0,32,32,x,y-12,-y*3); if !instance_place(x+16,y+12,obj_Lantern) and random(1)&lt;0.5 instance_create(x+16,y-8,obj_Lantern);}//TOP
            if tile_layer_find(100,x-32,y) //and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32) and !tile_layer_find(-room_height+1,x-32,y)
            {tile_add(global.outline,0,32,32,32,x,y-12,-y*3); if (random(1)&lt;0.5) instance_create(x-4,y+8,obj_Lantern);} //LEFT    
            if tile_layer_find(100,x+32,y) //and !tile_layer_find(100,x,y+32) and !tile_layer_find(100,x,y-32)  and !tile_layer_find(-room_height+1,x+32,y)
            {tile_add(global.outline,64,32,32,32,x,y-12,-y*3); if (random(1)&lt;0.5) instance_create(x+37,y+8,obj_Lantern);}//RIGHT        
            if tile_layer_find(100,x,y+32) //and !tile_layer_find(100,x+32,y) and !tile_layer_find(100,x-32,y) and !tile_layer_find(-room_height+1,x,y+32)
            {tile_add(global.outline,32,64,32,32,x,y-12,-y*3); if !instance_place(x+16,y+12,obj_Lantern) and random(1)&lt;0.5 with instance_create(x+16,y+12,obj_Lantern) {depth= -y*4;}}//BOTTOM        
        }
        
        if tile_layer_find(100,x,y+32)
            tile_add(global.tile_top,0,0,32,24,x,y-8,-y*2)
        else
            tile_add(global.tile_top,0,0,32,32,x,y-8,-y*2)
    }               
}
/*with (obj_Floor_Mark)
{
    instance_destroy();
}*/





</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///MUSIC
if global.dungeon_name == ENVIRO1
{
    if global.LVLMUSIC != snd_back1 then audio_stop_sound(global.LVLMUSIC);    
    global.LVLMUSIC = snd_back1;
}
if global.dungeon_name == SECRET1
{
    if global.LVLMUSIC != snd_forbidden_library then audio_stop_sound(global.LVLMUSIC);        
    global.LVLMUSIC = snd_forbidden_library;
}
if global.dungeon_name == ENVIRO2
{
    if global.LVLMUSIC != snd_sewers then audio_stop_sound(global.LVLMUSIC);    
    global.LVLMUSIC = snd_sewers;
}
if global.dungeon_name == ENVIRO3
{
    if global.LVLMUSIC != snd_frost_cavern then audio_stop_sound(global.LVLMUSIC);    
    global.LVLMUSIC = snd_frost_cavern;
}
if global.dungeon_name == SECRET2        
{
    if global.LVLMUSIC != snd_fae_garden then audio_stop_sound(global.LVLMUSIC);    
    global.LVLMUSIC = snd_fae_garden;
}
if global.dungeon_name == ENVIRO4
{
    if global.LVLMUSIC != snd_cathedral then audio_stop_sound(global.LVLMUSIC);    
    global.LVLMUSIC = snd_cathedral;
}
if global.dungeon_name == ENVIRO5
{
    if global.LVLMUSIC != snd_judgement then audio_stop_sound(global.LVLMUSIC);    
    global.LVLMUSIC = snd_judgement;  
}

if ( global.boss_rm+1 != 3 ) {
    Play_Music(global.LVLMUSIC,1,.7,.7,5000,true,true);
} else {
    audio_stop_sound(global.LVLMUSIC);
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Destroy
instance_destroy();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///global.generated = 2;
global.generated = 2;
//createBorder(obj_Wall);
alarm[2]=1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Clearer Inter
with obj_Clearer {
    if place_free(x-32,y-32) instance_create(x-32,y-32,obj_Wall);
    if place_free(x,y-32) instance_create(x,y-32,obj_Wall);
    if place_free(x+32,y-32) instance_create(x+32,y-32,obj_Wall);
    if place_free(x-32,y) instance_create(x-32,y,obj_Wall);            
    if place_free(x+32,y) instance_create(x+32,y,obj_Wall);
    if place_free(x-32,y+32) instance_create(x-32,y+32,obj_Wall);
    if place_free(x,y+32) instance_create(x,y+32,obj_Wall);
    if place_free(x+32,y+32) instance_create(x+32,y+32,obj_Wall);            
    //instance_destroy();
}

global.generated = 1;
alarm[1] = 2;
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>0,0</point>
    <point>16,16</point>
  </PhysicsShapePoints>
</object>
